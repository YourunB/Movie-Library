<section class="upcoming-section">
  <h2 class="section-title">Upcoming Movies</h2>

  @if (movies$ | async; as movies) { @if (cardWidth$ | async; as cardWidth) {
  <div class="slider-wrapper">
    <button
      mat-icon-button
      class="nav prev"
      (click)="scroll('prev', cardWidth)"
    >
      <mat-icon>chevron_left</mat-icon>
    </button>

    <div class="slider" #slider>
      @for (movie of movies; track movie.id) {
      <a [routerLink]="['/movie', movie.id]" class="movie-link">
        <mat-card class="movie-card">
          <img mat-card-image [src]="movie.poster_path" [alt]="movie.title" />
          <mat-card-content class="content">
            @if(isAuth$ | async) {
            <mat-icon
              [ngClass]="{
                'in-watchlist':
                  watchListService.isMovieInWatchlist(movie.id) | async
              }"
              class="favorite-icon"
              (click)="toggleFavorite($event, movie)"
              >favorite</mat-icon
            >
            }
            <h3 class="title">{{ movie.title }}</h3>
            <p class="release">{{ movie.release_date| date : "longDate" }}</p>
          </mat-card-content>
        </mat-card>
      </a>
      }
    </div>

    <button
      mat-icon-button
      class="nav next"
      (click)="scroll('next', cardWidth)"
    >
      <mat-icon>chevron_right</mat-icon>
    </button>
  </div>
  } }
</section>
